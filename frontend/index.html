<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Só Joga</title>
    <link rel="stylesheet" href="static/css/style.css">
    <link rel="icon" type="image/png" href="img/So Joga.png">
</head>
<body>
    <header class="navbar">
        <div class="logo">
            <img src="img/So Joga.png" alt="Só Joga">
        </div>
        <nav class="menu">
            <ul>
                <li><a href="index.html">Página Inicial</a></li>
                <li><a href="#">Sobre Nós</a></li>
                <li><a href="#">Serviços</a></li>
                <li><a href="#">Contato</a></li>
                <li><a href="cadastro.html">Cadastre-se</a></li>
                <li><a href="#" id="login-btn">Login</a></li>
            </ul>
        </nav>
    </header>

    <!-- Caixa de Login Flutuante -->
    <div id="login-popup">
        <form id="loginForm">
            <h2>Login</h2>
            <div class="form-group">
                <label for="popup-username">Usuário:</label>
                <input type="text" id="popup-username" name="username" required>
            </div>
            <div class="form-group">
                <label for="popup-password">Senha:</label>
                <input type="password" id="popup-password" name="password" required>
            </div>
            <button type="submit">Entrar</button>
            <div id="message"></div>
        </form>
    </div>

    <main>
        <section>
            <h1>Bem-vindo ao Só Joga!</h1>
            <p>Sua plataforma para encontrar e organizar eventos esportivos.</p>
        </section>
    </main>

    <script>
    // --- Lógica para controlar a caixa de login flutuante ---
    const loginBtn = document.getElementById('login-btn');
    const loginPopup = document.getElementById('login-popup');

    loginBtn.addEventListener('click', function(event) {
        event.preventDefault();
        loginPopup.classList.toggle('show');
    });

    // Fecha o popup se o usuário clicar fora dele
    window.addEventListener('click', function(event) {
        if (!loginPopup.contains(event.target) && !loginBtn.contains(event.target)) {
            loginPopup.classList.remove('show');
        }
    });

    // --- Lógica para o formulário de login ---
    document.getElementById('loginForm').addEventListener('submit', async function(event) {
        event.preventDefault();

        const messageDiv = document.getElementById('message');
        const loginData = {
            username: document.getElementById('popup-username').value,
            password: document.getElementById('popup-password').value
        };

        const backendUrl = 'http://localhost:8787/api/login';

        try {
            const response = await fetch(backendUrl, { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(loginData) });
            if (response.ok) {
                const result = await response.json();
                messageDiv.className = 'success';
                messageDiv.textContent = `Login bem-sucedido! Bem-vindo, ${result.username}.`;
                setTimeout(() => loginPopup.classList.remove('show'), 1500); // Fecha o popup após o sucesso
            } else {
                messageDiv.className = 'error';
                messageDiv.textContent = 'Usuário ou senha inválidos.';
            }
        } catch (error) {
            messageDiv.className = 'error';
            messageDiv.textContent = 'Erro de conexão com o servidor. Verifique se o backend está rodando.';
            console.error('Erro:', error);
        }
    });
    </script>
</body>
</html>
